---
title: 2025.8.11 æµ‹è¯•æ¸¸è®°
tags: [åŸåˆ›]
categories: [é¢˜è§£]
date: 2025-8-11
description: ğŸ˜ 
articleGPT: è¿™ç¯‡æ–‡ç« çš„ä½œè€…é€šè¿‡é€æ­¥åˆ†æï¼Œä»ç®€å•çš„åŠ¨æ€è§„åˆ’é—®é¢˜å…¥æ‰‹ï¼Œç»“åˆ k è¾ƒå°çš„ç‰¹ç‚¹ï¼Œæœ€ç»ˆæ¨å¯¼å‡ºç”¨å®¹æ–¥åŸç†å’Œç»„åˆæ•°å­¦è§£å†³é—®é¢˜çš„æ€è·¯ï¼Œå¼ºè°ƒäº†é¢„å¤„ç†ç»„åˆæ•°çš„é‡è¦æ€§ã€‚
---

è€ƒè¯•æ—¶å”¯ä¸€æƒ³åˆ°æ­£è§£çš„é¢˜ï¼Œä½†å› ä¸ºæ²¡æœ‰é¢„å¤„ç† $100\to 25$ã€‚

## é¢˜é¢

æ´›è°·æ²¡æ‰¾åˆ°åŸé¢˜ï¼ŒæŒ‚ä¸€ä¸‹é¢˜é¢ï¼š

> æœ‰ä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„æ£‹ç›˜ï¼Œä¸Šé¢æ¶‚æ»¡äº†é¢œè‰²ï¼Œæœ‰é»‘è‰²ï¼Œä¹Ÿæœ‰ç™½è‰²ï¼Œç°åœ¨æ£‹ç›˜çš„å·¦ä¸Šè§’æœ‰ä¸€ä¸ªå’ï¼Œæ¯ä¸€æ­¥å¯ä»¥å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ ¼ï¼Œè¦æ±‚ä¸èƒ½ç§»åŠ¨åˆ°é»‘è‰²çš„æ ¼å­ä¸Šï¼Œé—®å’è¦èµ°åˆ°æ£‹ç›˜çš„å³ä¸‹è§’æœ‰å¤šå°‘ç§å¯è¡Œçš„æ–¹æ¡ˆï¼Ÿç­”æ¡ˆå¯¹ $10^9+7$å–æ¨¡
> 
> å¯¹äº $30\%$ çš„æ•°æ®ä¿è¯ $1\le n,m\le 2000,1\le k \le 2000$ã€‚  
> å¯¹äº $100\%$ çš„æ•°æ®ä¿è¯ $1 \le n,m \le 100000, 1 \le k \le 2000$ã€‚
> 
> **è¾“å…¥æ ¼å¼**
> 
> ç¬¬ä¸€è¡Œä¸‰ä¸ªæ•° $n$ å’Œ $m$ å’Œ $k$,è¡¨ç¤ºæ£‹ç›˜æœ‰ $n$ è¡Œ $m$ åˆ—ï¼Œå…¶ä¸­æ£‹ç›˜ä¸Šæœ‰ $k$ ä¸ªé»‘è‰²çš„æ ¼å­ã€‚
> 
> æ¥ä¸‹æ¥ $k$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•° $x$ å’Œ $y$ï¼Œåˆ†åˆ«è¡¨ç¤ºè¿™ $k$ ä¸ªé»‘è‰²æ ¼å­çš„åæ ‡ ä½äºç¬¬ $x$ è¡Œ $y$ åˆ—ã€‚
> 
> **è¾“å‡ºæ ¼å¼**
> 
> ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ–¹æ¡ˆæ•°ã€‚

ç¬¬ä¸€çœ¼ï¼šè¿™ä¸ DP å…¥é—¨é¢˜å—ï¼Ÿ

ç¬¬äºŒçœ¼ï¼š$1 \le n,m \le 100000$ å•Šï¼Œé‚£æ²¡äº‹äº†ã€‚

å¾ˆæ˜æ˜¾ $O(nm)$ åªèƒ½æ‹¿ $30pt$ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾æ›´ä¼˜è§£ï¼Œå¯ä»¥å‘ç° $k$ éå¸¸å°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä» $k$ å¼€å§‹æ€è€ƒã€‚

## æ€è·¯

æˆ‘ä»¬å¯ä»¥è¿ç”¨ä¸€äº›ç¥ç§˜ Excel ç§‘æŠ€æ¥è¾…åŠ©æ€è€ƒã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/vr7dgdcv.png)

è¿™æ˜¯åœ¨æ²¡æœ‰é»‘æ ¼æ—¶çš„æƒ…å†µï¼Œè½¬ç§»æ–¹ç¨‹æ˜¯ $f_{i,j}=f_{i-1,j}+f_{i,j-1}$ã€‚ä½†æˆ‘ä»¬å‰é¢å·²ç»çŸ¥é“äº†ï¼Œè¿™ç§æ–¹æ³•æ˜¾ç„¶ä¸å¯å–ã€‚

æˆ‘ä»¬å°† $(3,3)$ å»æ‰æ‰¾æ‰¾è§„å¾‹ã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/kuf6rqh9.png)

å¯ä»¥å‘ç°ï¼Œ$(3,3)$ å³ä¸‹æ–¹çš„çŸ©é˜µçš„å„ä¸ªå…ƒç´ æ•°å€¼éƒ½æœ‰å‡å°‘ï¼Œæˆ‘ä»¬å†æ ‡æ³¨ä¸€ä¸‹ã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/w83v54qo.png)

~~è¿™ä¸æ˜¯æ²¡å•¥è§„å¾‹å—~~ã€‚åˆ«æ€¥ï¼Œä»”ç»†çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°å‡å°‘çš„å€¼ $\div 6$ æ­£å¥½æ˜¯ä¸€ä¸ªæ¨è¾‰ä¸‰è§’ã€‚

èµ°åˆ°è¿™ä¸€æ­¥æƒ³å¿…å¤§å®¶éƒ½æ‡‚äº†ï¼Œå°±æ˜¯é€šè¿‡æšä¸¾æ¯ä¸€ä¸ªè¢«æŒ–æ‰çš„æ ¼å­æ¥è®¡ç®—å¯¹ $(n,m)$ çš„å½±å“ã€‚

**ä½†æ˜¯**ï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œä¸€ä¸ªé»‘è‰²æ ¼å­ä¼šå½±å“å…¶ä»–çš„é»‘è‰²æ ¼å­ï¼Œä¾‹å¦‚ä¸‹é¢ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/b4t2m60u.png)

ä½äº $(3,3)$ çš„æ ¼å­ä¼šå½±å“åˆ° $(4,4)$ çš„æ ¼å­ï¼Œä»è€Œä½¿ (4,4) å¯¹åé¢çš„å½±å“äº§ç”Ÿå˜åŒ–ï¼Œç”¨ OI çš„è¯­è¨€è¯´å°±æ˜¯å­˜åœ¨åæ•ˆæ€§ï¼Œä¸ºäº†æ¶ˆé™¤åæ•ˆæ€§æˆ‘ä»¬è¦åœ¨å¤„ç†ä¹‹å‰è¿›è¡Œæ’åºã€‚

é‚£æœ‰äººå°±è¦é—®äº†ï¼šé‚£è¿™æ ·æšä¸¾å­çŸ©é˜µè¿˜æ˜¯ä¼šè¶…æ—¶å•Šã€‚

ä¸æ˜¯å“¥ä»¬æˆ‘ä¹Ÿæ²¡è¯´è¦æš´åŠ›æšä¸¾æ•´ä¸ªå­çŸ©é˜µå•Šï¼Œæˆ‘ä»¬åªéœ€è¦æšä¸¾é»‘è‰²æ ¼å­è®¡ç®—æœ€ç»ˆå½±å“å³å¯ã€‚

æˆ‘ä»¬å‡è®¾ $(x,y)$ ä¸ºé»‘è‰²æ ¼å­ï¼Œè®¾ $f_{i,j}$ ä¸ºå…¶åœ¨è®¡ç®—å…¶ä»–é»‘è‰²æ ¼å­äº§ç”Ÿçš„å½±å“åçš„æ•°å€¼ï¼Œé‚£å…¶å¯¹ $(n,m)$ çš„å½±å“ä¸º $C_{n+m-x-y}^{m-y}$ï¼Œè¿™ä¸€ç‚¹æ‰‹æ¨ä¸€ä¸‹å³å¯å¾—å‡ºã€‚

ç»„åˆæ•°çš„è®¡ç®—è¦ç”¨é€†å…ƒï¼Œä¸ä¼šçš„å»ºè®®è‡ªè¡Œ bdfsï¼Œ**åƒä¸‡è¦è®°å¾—é¢„å¤„ç†**ï¼Œå¦åˆ™å°±ä¼šåƒæˆ‘ä¸€æ · T é£ï¼Œé€Ÿåº¦ç”šè‡³è·‘ä¸è¿‡æš´åŠ›ã€‚

## ä»£ç 

ç é£æ¯”è¾ƒæŠ½è±¡ï¼Œè¿˜è¯·å„ä½è§è°…ã€‚

```cpp
#include<bits/stdc++.h>
#define int long long
#define pii pair<int,int>
#ifdef __linux__
#define getchar getchar_unlocked
#define putchar putchar_unlocked
#else
#define getchar _getchar_nolock
#define putchar _putchar_nolock
#endif
using namespace std;
namespace FastIO{
	void read(){}
	template<class T1,class...T2>inline void read(T1&x,T2&...oth){
		bool pd=0;x=0;char ch=getchar();
		while(!isdigit(ch)){pd|=ch=='-';ch=getchar();}
		while(isdigit(ch)){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}
		x=pd?-x:x;
		read(oth...);
	}
	template<class T>void _write(T x){
		if(x<0){putchar('-');x=-x;}
		if(x>9)_write(x/10);
		putchar(x%10^48);
	}
	void write(){}
	template<class T1,class...T2>inline void write(T1 x,T2...oth){
		_write(x);putchar(' ');write(oth...);
	}
	inline void endline(){putchar('\n');}
}
using namespace FastIO;
const int mod=1e9+7,N=5e5+5;
int n,m,k;
pii a[2003];
int f[2003],fact[N+5],invF[N+5];
int mi(int a,int b){
	int res=1;
	while(b){
		if(b&1)res=res*a%mod;
		a=a*a%mod;
		b>>=1;
	}
	return res;
}
void pre_C(int mx){
	fact[0]=1;
	for(int i=1;i<=mx;i++)fact[i]=fact[i-1]*i%mod;
	invF[mx]=mi(fact[mx],mod-2);
	for(int i=mx-1;i>=0;i--)invF[i]=invF[i+1]*(i+1)%mod;
}
int C(int a,int b){
	if(b<0||b>a)return 0;
	return fact[a]*invF[b]%mod*invF[a-b]%mod;
}
bool cmp(pii a,pii b){
	if(a.first!=b.first)return a.first<b.first;
	return a.second<b.second;
}
int fun(int x,int y){
	return C(x+y-2,y-1);
}
signed main(){
	read(n,m,k);
	pre_C(n+m-2);
	for(int i=1;i<=k;i++){
		read(a[i].first,a[i].second);
		if((a[i].first==1&&a[i].second==1)||(a[i].first==n&&a[i].second==m)){
			cout<<0;
			return 0;
		}
	}
	sort(a+1,a+k+1,cmp);
	for(int i=1;i<=k;i++)f[i]=fun(a[i].first,a[i].second);
	for(int i=1;i<=k;i++){
		int x=a[i].first,y=a[i].second;
		for(int j=1;j<=k;j++)
			if(a[j].first>=x&&a[j].second>=y&&i!=j)
				f[j]=(f[j]-fun(a[j].first-x+1,a[j].second-y+1)*f[i]%mod+mod)%mod;
	}
	int ans=fun(n,m);
	for(int i=1;i<=k;i++){
		int x=a[i].first,y=a[i].second;
		ans=(ans-fun(n-x+1,m-y+1)*f[i]%mod+mod)%mod;
	}
	cout<<ans;
	return 0;
}
```

ç»ˆäºå†™å®Œäº†â€¦â€¦

## è‡´è°¢åå•

- [zxxï¼ˆå¹¶éçœŸåï¼‰](https://www.luogu.com.cn/user/1167457)ï¼šæä¾›è¡¨æ ¼ã€‚
